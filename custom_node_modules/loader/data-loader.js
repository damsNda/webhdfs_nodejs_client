'use strict';
var walk = require('walk');
var fs = require('fs');
var http = require('http');
var util=require('util');
const url = require('url');
let hdfsManager = require ('../hdfs/hdfs_manager.js');
let file = require ('../util/file.js');
let path='files_sample/baseballdatabank-2017.1/core/';

exports.init=function(){
	return new Promise(function(resolve, reject) {
		console.log("Debut chargement des donn√©es");
		
		let walker = walk.walk(path);
		walker.on("file", function (root, fileStats, next) {
			hdfsManager.putFile(file.newFile(path,fileStats.name),true).then(next());
		});
		
	});
};